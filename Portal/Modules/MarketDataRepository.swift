//
//  MarketDataRepository.swift
//  Portal
//
//  Created by Farid on 14.04.2020.
//  Copyright Â© 2020 Tides Network. All rights reserved.
//

import Foundation
import SwiftUI
import Combine

final class MarketDataRepository: MarketData  {
    @ObservedObject private var ratesUpdater = RatesDataUpdater(interval: 60)
    @ObservedObject private var priceUpdater = PricesDataUpdater(interval: 60)
    
    private var ratesUpdaterCancellable: AnyCancellable?
    private var priceUpdaterCancellable: AnyCancellable?
    
    private var currencyRates = Synchronized([String: Double]())
    private var marketData = Synchronized([String: CoinMarketData]())
    
    init() {
        ratesUpdaterCancellable = ratesUpdater.onUpdatePublisher
            .print()
            .sink(receiveValue: { [weak self] rates in
                guard let self = self else { return }
                self.update(rates)
        })
        priceUpdaterCancellable = priceUpdater.onUpdatePublisher
            .print()
            .sink(receiveValue: { [weak self] prices in
                guard let self = self else { return }
                self.update(prices)
        })
    }
    
    deinit {
        ratesUpdaterCancellable?.cancel()
        priceUpdaterCancellable?.cancel()
    }
    
    func marketData(for coin: String) -> CoinMarketData {
        marketData.value[coin] ?? CoinMarketData()
    }

    func rate(for currency: FiatCurrency) -> Double {
        let code = currency.code
        return currencyRates.value[code] ?? 1.0
    }
}

extension MarketDataRepository {
    private func update(_ rates: Rates) {
        currencyRates.writer({ (data) in
            data = rates.filter{$0.key != "BTC"}
        })
    }
    
    private func update(_ prices: PriceResponse) {
        for price in prices {
            if marketData.value[price.key] == nil {
                marketData.writer({ (data) in
                    data[price.key] = CoinMarketData()
                })
            }
            for currency in price.value {
                marketData.writer({ (data) in
                    data[price.key]?.priceData[currency.key] = currency.value
                })
            }
        }
    }
}

let fullPriceResponse = """
{"BTC":{"BTC":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"BTC","TOSYMBOL":"BTC","FLAGS":"2052","PRICE":1,"LASTUPDATE":1576216058,"MEDIAN":1.000099960015993,"LASTVOLUME":0.0443971362,"LASTVOLUMETO":0.0443971362,"LASTTRADEID":"15762160580004","VOLUMEDAY":4157.655725194683,"VOLUMEDAYTO":4157.655725194683,"VOLUME24HOUR":23041.345866876,"VOLUME24HOURTO":23041.345866876,"OPENDAY":0.9945328031809145,"HIGHDAY":1.001501501501501,"LOWDAY":0.9930521091811414,"OPEN24HOUR":1.007552870090634,"HIGH24HOUR":1.011627906976744,"LOW24HOUR":0.9905940594059406,"LASTMARKET":"Bibox","VOLUMEHOUR":487.9879572916378,"VOLUMEHOURTO":487.9879572916378,"OPENHOUR":1,"HIGHHOUR":1.001501501501501,"LOWHOUR":0.9970104633781763,"TOPTIERVOLUME24HOUR":9934.640229136094,"TOPTIERVOLUME24HOURTO":9934.640229136094,"CHANGE24HOUR":-0.00755287009063399,"CHANGEPCT24HOUR":-0.7496251874062524,"CHANGEDAY":0.005467196819085474,"CHANGEPCTDAY":0.5497251374312829,"CHANGEHOUR":0,"CHANGEPCTHOUR":0,"SUPPLY":18098562,"MKTCAP":18098562,"TOTALVOLUME24H":294029.33528654306,"TOTALVOLUME24HTO":294029.33528654306,"TOTALTOPTIERVOLUME24H":162419.20691932726,"TOTALTOPTIERVOLUME24HTO":162419.20691932726,"IMAGEURL":"/media/19633/btc.png","CONVERSIONTYPE":"invert_divide","CONVERSIONSYMBOL":"ETH"},"USD":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"BTC","TOSYMBOL":"USD","FLAGS":"2049","PRICE":7236.25,"LASTUPDATE":1576216070,"MEDIAN":7217.84,"LASTVOLUME":0.00076035,"LASTVOLUMETO":5.510787677727735,"LASTTRADEID":"404027263","VOLUMEDAY":3589.918700966946,"VOLUMEDAYTO":25960534.223317187,"VOLUME24HOUR":21253.61012649521,"VOLUME24HOURTO":153235707.25434572,"OPENDAY":7201.5,"HIGHDAY":7247.57,"LOWDAY":7199.49,"OPEN24HOUR":7179.48,"HIGH24HOUR":7275.09,"LOW24HOUR":7125.71,"LASTMARKET":"Bitfinex","VOLUMEHOUR":609.994683130999,"VOLUMEHOURTO":4421369.7773474315,"OPENHOUR":7233.47,"HIGHHOUR":7237.93,"LOWHOUR":7220.64,"TOPTIERVOLUME24HOUR":19277.72337800721,"TOPTIERVOLUME24HOURTO":138704329.27671632,"CHANGE24HOUR":56.77000000000044,"CHANGEPCT24HOUR":0.790725790725797,"CHANGEDAY":34.75,"CHANGEPCTDAY":0.48253836006387557,"CHANGEHOUR":2.7799999999997453,"CHANGEPCTHOUR":0.03843245358036662,"SUPPLY":18098562,"MKTCAP":130965719272.5,"TOTALVOLUME24H":294029.33528654306,"TOTALVOLUME24HTO":2127109048.443742,"TOTALTOPTIERVOLUME24H":162419.20691932726,"TOTALTOPTIERVOLUME24HTO":1174511889.5525935,"IMAGEURL":"/media/19633/btc.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"ETH":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"BTC","TOSYMBOL":"ETH","FLAGS":"2052","PRICE":49.97501249375313,"LASTUPDATE":1576216058,"MEDIAN":49.98000799680128,"LASTVOLUME":0.0443971362,"LASTVOLUMETO":2.22,"LASTTRADEID":"15762160580004","VOLUMEDAY":4157.655725194683,"VOLUMEDAYTO":207383.50424606708,"VOLUME24HOUR":23041.345866876,"VOLUME24HOURTO":1151203.7463415146,"OPENDAY":49.70178926441352,"HIGHDAY":50.05005005005005,"LOWDAY":49.62779156327543,"OPEN24HOUR":50.35246727089628,"HIGH24HOUR":50.55611729019211,"LOW24HOUR":49.50495049504951,"LASTMARKET":"Bibox","VOLUMEHOUR":487.9879572916378,"VOLUMEHOURTO":24395.629650400282,"OPENHOUR":49.97501249375313,"HIGHHOUR":50.05005005005005,"LOWHOUR":49.82561036372695,"TOPTIERVOLUME24HOUR":9934.640229136094,"TOPTIERVOLUME24HOURTO":496039.85855669447,"CHANGE24HOUR":-0.37745477714315,"CHANGEPCT24HOUR":-0.7496251874062959,"CHANGEDAY":0.27322322933960663,"CHANGEPCTDAY":0.5497251374312885,"CHANGEHOUR":0,"CHANGEPCTHOUR":0,"SUPPLY":18098562,"MKTCAP":904475862.0689656,"TOTALVOLUME24H":294029.33528654306,"TOTALVOLUME24HTO":14693831.903246416,"TOTALTOPTIERVOLUME24H":162419.20691932726,"TOTALTOPTIERVOLUME24HTO":8116457.98400353,"IMAGEURL":"/media/19633/btc.png","CONVERSIONTYPE":"invert","CONVERSIONSYMBOL":""}},"BCH":{"BTC":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"BCH","TOSYMBOL":"BTC","FLAGS":"2052","PRICE":0.02872,"LASTUPDATE":1576216059,"MEDIAN":0.028713,"LASTVOLUME":2.9024,"LASTVOLUMETO":0.0833366112,"LASTTRADEID":"15762160590001","VOLUMEDAY":49006.65333296978,"VOLUMEDAYTO":1407.405782887538,"VOLUME24HOUR":244515.70834498992,"VOLUME24HOURTO":7017.081502246643,"OPENDAY":0.02871,"HIGHDAY":0.0288,"LOWDAY":0.02867,"OPEN24HOUR":0.02858,"HIGH24HOUR":0.02884,"LOW24HOUR":0.02852,"LASTMARKET":"bhex","VOLUMEHOUR":6641.027321900002,"VOLUMEHOURTO":190.82738920527777,"OPENHOUR":0.02873,"HIGHHOUR":0.0288,"LOWHOUR":0.02869,"TOPTIERVOLUME24HOUR":123080.47104213001,"TOPTIERVOLUME24HOURTO":3532.231796000977,"CHANGE24HOUR":0.00013999999999999777,"CHANGEPCT24HOUR":0.4898530440867661,"CHANGEDAY":0.000009999999999999593,"CHANGEPCTDAY":0.03483106931382651,"CHANGEHOUR":-0.000009999999999999593,"CHANGEPCTHOUR":-0.03480682213713746,"SUPPLY":18163989.6469082,"MKTCAP":521669.7826592035,"TOTALVOLUME24H":825613.4599683434,"TOTALVOLUME24HTO":23706.208928869353,"TOTALTOPTIERVOLUME24H":407667.6338644071,"TOTALTOPTIERVOLUME24HTO":11705.575112256774,"IMAGEURL":"/media/35650680/bch.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"USD":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"BCH","TOSYMBOL":"USD","FLAGS":"2052","PRICE":207.63,"LASTUPDATE":1576216033,"MEDIAN":207.5,"LASTVOLUME":0.43059,"LASTVOLUMETO":93.48651873,"LASTTRADEID":"128473245","VOLUMEDAY":16074.253217030018,"VOLUMEDAYTO":3334247.7188769537,"VOLUME24HOUR":68096.39093509,"VOLUME24HOURTO":14060259.444270825,"OPENDAY":206.67,"HIGHDAY":208.45,"LOWDAY":206.58,"OPEN24HOUR":205.09,"HIGH24HOUR":208.57,"LOW24HOUR":204.09,"LASTMARKET":"Exmo","VOLUMEHOUR":1738.40862395,"VOLUMEHOURTO":361128.09033282887,"OPENHOUR":207.77,"HIGHHOUR":208.04,"LOWHOUR":207.19,"TOPTIERVOLUME24HOUR":66866.57977512,"TOPTIERVOLUME24HOURTO":13796559.44632015,"CHANGE24HOUR":2.539999999999992,"CHANGEPCT24HOUR":1.2384806670242294,"CHANGEDAY":0.960000000000008,"CHANGEPCTDAY":0.4645086369574723,"CHANGEHOUR":-0.14000000000001478,"CHANGEPCTHOUR":-0.06738220147278952,"SUPPLY":18163989.6469082,"MKTCAP":3771389170.38755,"TOTALVOLUME24H":825613.4599683434,"TOTALVOLUME24HTO":171343528.4876452,"TOTALTOPTIERVOLUME24H":407667.6338644071,"TOTALTOPTIERVOLUME24HTO":84557082.30687882,"IMAGEURL":"/media/35650680/bch.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"ETH":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"BCH","TOSYMBOL":"ETH","FLAGS":"2052","PRICE":1.436,"LASTUPDATE":1576216046,"MEDIAN":1.434,"LASTVOLUME":0.76,"LASTVOLUMETO":1.0912059024,"LASTTRADEID":"15762160460006","VOLUMEDAY":5647.827343210013,"VOLUMEDAYTO":8089.884427940288,"VOLUME24HOUR":23060.89344267,"VOLUME24HOURTO":33051.86146345552,"OPENDAY":1.427,"HIGHDAY":1.439,"LOWDAY":1.426,"OPEN24HOUR":1.44,"HIGH24HOUR":1.448,"LOW24HOUR":1.421,"LASTMARKET":"Bibox","VOLUMEHOUR":794.7847127600003,"VOLUMEHOURTO":1141.3460919727786,"OPENHOUR":1.437,"HIGHHOUR":1.439,"LOWHOUR":1.434,"TOPTIERVOLUME24HOUR":2.5041,"TOPTIERVOLUME24HOURTO":3.599552778,"CHANGE24HOUR":-0.0040000000000000036,"CHANGEPCT24HOUR":-0.27777777777777807,"CHANGEDAY":0.008999999999999897,"CHANGEPCTDAY":0.6306937631394461,"CHANGEHOUR":-0.001000000000000112,"CHANGEPCTHOUR":-0.0695894224078018,"SUPPLY":18163989.6469082,"MKTCAP":26083489.132960174,"TOTALVOLUME24H":825613.4599683434,"TOTALVOLUME24HTO":1185517.3469943225,"TOTALTOPTIERVOLUME24H":407667.6338644071,"TOTALTOPTIERVOLUME24HTO":585410.7258944665,"IMAGEURL":"/media/35650680/bch.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""}},"ETH":{"BTC":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"ETH","TOSYMBOL":"BTC","FLAGS":"2052","PRICE":0.02001,"LASTUPDATE":1576216058,"MEDIAN":0.020008,"LASTVOLUME":2.22,"LASTVOLUMETO":0.0443971362,"LASTTRADEID":"15762160580004","VOLUMEDAY":207383.50424606708,"VOLUMEDAYTO":4157.655725194683,"VOLUME24HOUR":1151203.7463415146,"VOLUME24HOURTO":23041.345866876,"OPENDAY":0.02012,"HIGHDAY":0.02015,"LOWDAY":0.01998,"OPEN24HOUR":0.01986,"HIGH24HOUR":0.0202,"LOW24HOUR":0.01978,"LASTMARKET":"Bibox","VOLUMEHOUR":24395.629650400282,"VOLUMEHOURTO":487.9879572916378,"OPENHOUR":0.02001,"HIGHHOUR":0.02007,"LOWHOUR":0.01998,"TOPTIERVOLUME24HOUR":496039.85855669447,"TOPTIERVOLUME24HOURTO":9934.640229136094,"CHANGE24HOUR":0.00015000000000000083,"CHANGEPCT24HOUR":0.7552870090634484,"CHANGEDAY":-0.00010999999999999899,"CHANGEPCTDAY":-0.5467196819085437,"CHANGEHOUR":0,"CHANGEPCTHOUR":0,"SUPPLY":108897244.4365,"MKTCAP":2179033.861174365,"TOTALVOLUME24H":4113202.324515517,"TOTALVOLUME24HTO":82310.93741613778,"TOTALTOPTIERVOLUME24H":1842416.7786091228,"TOTALTOPTIERVOLUME24HTO":36875.64239938518,"IMAGEURL":"/media/20646/eth_logo.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"USD":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"ETH","TOSYMBOL":"USD","FLAGS":"2052","PRICE":144.74,"LASTUPDATE":1576216070,"MEDIAN":144.43,"LASTVOLUME":0.17245166,"LASTVOLUMETO":25.0072152166,"LASTTRADEID":"404013084","VOLUMEDAY":13418.977795950037,"VOLUMEDAYTO":1944972.370474587,"VOLUME24HOUR":146574.516141596,"VOLUME24HOURTO":21114856.49292892,"OPENDAY":145.08,"HIGHDAY":145.39,"LOWDAY":144.45,"OPEN24HOUR":142.41,"HIGH24HOUR":146.44,"LOW24HOUR":141.14,"LASTMARKET":"Bitfinex","VOLUMEHOUR":915.1586301600003,"VOLUMEHOURTO":132980.6611878509,"OPENHOUR":144.82,"HIGHHOUR":144.84,"LOWHOUR":144.58,"TOPTIERVOLUME24HOUR":141835.99669117,"TOPTIERVOLUME24HOURTO":20409305.759808928,"CHANGE24HOUR":2.3300000000000125,"CHANGEPCT24HOUR":1.6361210589144108,"CHANGEDAY":-0.3400000000000034,"CHANGEPCTDAY":-0.23435346015991412,"CHANGEHOUR":-0.07999999999998408,"CHANGEPCTHOUR":-0.055240988813688774,"SUPPLY":108897244.4365,"MKTCAP":15761787159.73901,"TOTALVOLUME24H":4113202.324515517,"TOTALVOLUME24HTO":595244565.4769702,"TOTALTOPTIERVOLUME24H":1842416.7786091228,"TOTALTOPTIERVOLUME24HTO":266551368.13461345,"IMAGEURL":"/media/20646/eth_logo.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"ETH":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"ETH","TOSYMBOL":"ETH","FLAGS":"2052","PRICE":1,"LASTUPDATE":1576216058,"MEDIAN":0.9999000499750126,"LASTVOLUME":2.22,"LASTVOLUMETO":2.22,"LASTTRADEID":"15762160580004","VOLUMEDAY":207383.50424606708,"VOLUMEDAYTO":207383.5042460671,"VOLUME24HOUR":1151203.7463415146,"VOLUME24HOURTO":1151203.746341515,"OPENDAY":1.005497251374313,"HIGHDAY":1.006996501749126,"LOWDAY":0.9985007496251874,"OPEN24HOUR":0.992503748125937,"HIGH24HOUR":1.009495252373813,"LOW24HOUR":0.9885057471264367,"LASTMARKET":"Bibox","VOLUMEHOUR":24395.629650400282,"VOLUMEHOURTO":24395.62965040028,"OPENHOUR":1,"HIGHHOUR":1.002998500749625,"LOWHOUR":0.9985007496251874,"TOPTIERVOLUME24HOUR":496039.85855669447,"TOPTIERVOLUME24HOURTO":496039.8585566945,"CHANGE24HOUR":0.007496251874062998,"CHANGEPCT24HOUR":0.7552870090634471,"CHANGEDAY":-0.005497251374313006,"CHANGEPCTDAY":-0.5467196819085648,"CHANGEHOUR":0,"CHANGEPCTHOUR":0,"SUPPLY":108897244.4365,"MKTCAP":108897244.4365,"TOTALVOLUME24H":4113202.324515517,"TOTALVOLUME24HTO":4113202.324515518,"TOTALTOPTIERVOLUME24H":1842416.7786091228,"TOTALTOPTIERVOLUME24HTO":1842416.7786091228,"IMAGEURL":"/media/20646/eth_logo.png","CONVERSIONTYPE":"divide","CONVERSIONSYMBOL":"BTC"}},"XLM":{"BTC":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"XLM","TOSYMBOL":"BTC","FLAGS":"2052","PRICE":0.00000724,"LASTUPDATE":1576216055,"MEDIAN":0.00000724,"LASTVOLUME":6896.55172414,"LASTVOLUMETO":0.05,"LASTTRADEID":"14971486","VOLUMEDAY":7844172.500312093,"VOLUMEDAYTO":56.63958199048623,"VOLUME24HOUR":63074830.85118119,"VOLUME24HOURTO":458.2006429143344,"OPENDAY":0.00000722,"HIGHDAY":0.00000724,"LOWDAY":0.0000072,"OPEN24HOUR":0.00000743,"HIGH24HOUR":0.00000746,"LOW24HOUR":0.00000714,"LASTMARKET":"Poloniex","VOLUMEHOUR":1181219.6193403332,"VOLUMEHOURTO":8.538425035770116,"OPENHOUR":0.00000722,"HIGHHOUR":0.00000724,"LOWHOUR":0.00000722,"TOPTIERVOLUME24HOUR":62002735.50374772,"TOPTIERVOLUME24HOURTO":450.3924342866093,"CHANGE24HOUR":-1.8999999999999987e-7,"CHANGEPCT24HOUR":-2.5572005383580065,"CHANGEDAY":1.999999999999981e-8,"CHANGEPCTDAY":0.27700831024930483,"CHANGEHOUR":1.999999999999981e-8,"CHANGEPCTHOUR":0.27700831024930483,"SUPPLY":20054779554,"MKTCAP":145196.60397096002,"TOTALVOLUME24H":269726070.60703355,"TOTALVOLUME24HTO":1954.3556187467057,"TOTALTOPTIERVOLUME24H":242564969.67228067,"TOTALTOPTIERVOLUME24HTO":1757.6630096667882,"IMAGEURL":"/media/35521289/xlm.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"USD":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"XLM","TOSYMBOL":"USD","FLAGS":"2049","PRICE":0.05232,"LASTUPDATE":1576216067,"MEDIAN":0.0524,"LASTVOLUME":395,"LASTVOLUMETO":20.652575,"LASTTRADEID":"2489768","VOLUMEDAY":4528694.767304056,"VOLUMEDAYTO":235950.5761647731,"VOLUME24HOUR":21508532.63519248,"VOLUME24HOURTO":1124117.755063225,"OPENDAY":0.05206,"HIGHDAY":0.05233,"LOWDAY":0.05189,"OPEN24HOUR":0.05266,"HIGH24HOUR":0.05328,"LOW24HOUR":0.05138,"LASTMARKET":"Coinbase","VOLUMEHOUR":788588.1871609201,"VOLUMEHOURTO":41115.607196228404,"OPENHOUR":0.05219,"HIGHHOUR":0.05233,"LOWHOUR":0.05208,"TOPTIERVOLUME24HOUR":21019764.45488131,"TOPTIERVOLUME24HOURTO":1097240.705113285,"CHANGE24HOUR":-0.00034,"CHANGEPCT24HOUR":-0.6456513482719332,"CHANGEDAY":0.00025999999999999635,"CHANGEPCTDAY":0.49942374183633564,"CHANGEHOUR":0.00012999999999999817,"CHANGEPCTHOUR":0.24908986395860924,"SUPPLY":20054779554,"MKTCAP":1049266066.26528,"TOTALVOLUME24H":269726070.60703355,"TOTALVOLUME24HTO":14110859.34174995,"TOTALTOPTIERVOLUME24H":242564969.67228067,"TOTALTOPTIERVOLUME24HTO":12688485.842087619,"IMAGEURL":"/media/35521289/xlm.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"ETH":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"XLM","TOSYMBOL":"ETH","FLAGS":"2052","PRICE":0.0003618190904547726,"LASTUPDATE":1576216058,"MEDIAN":0.0003618190904547726,"LASTVOLUME":6896.55172414,"LASTVOLUMETO":2.495304072102629,"LASTTRADEID":"14971486","VOLUMEDAY":7844172.500312093,"VOLUMEDAYTO":2838.171359433261,"VOLUME24HOUR":63074830.85118119,"VOLUME24HOURTO":22821.67792916301,"OPENDAY":0.0003608195902048976,"HIGHDAY":0.0003618190904547726,"LOWDAY":0.0003598200899550225,"OPEN24HOUR":0.0003713143428285857,"HIGH24HOUR":0.0003728135932033983,"LOW24HOUR":0.0003568215892053973,"LASTMARKET":"Poloniex","VOLUMEHOUR":1181219.6193403332,"VOLUMEHOURTO":427.3878082970521,"OPENHOUR":0.0003608195902048976,"HIGHHOUR":0.0003618190904547726,"LOWHOUR":0.0003608195902048976,"TOPTIERVOLUME24HOUR":62002735.50374772,"TOPTIERVOLUME24HOURTO":22433.77336567384,"CHANGE24HOUR":-0.00000949525237381308,"CHANGEPCT24HOUR":-2.5572005383580048,"CHANGEDAY":9.99500249875007e-7,"CHANGEPCTDAY":0.27700831024929207,"CHANGEHOUR":9.99500249875007e-7,"CHANGEPCTHOUR":0.27700831024929207,"SUPPLY":20054779554,"MKTCAP":7256202.09749925,"TOTALVOLUME24H":269726070.60703355,"TOTALVOLUME24HTO":97592.04153897666,"TOTALTOPTIERVOLUME24H":242564969.67228067,"TOTALTOPTIERVOLUME24HTO":87764.6367030141,"IMAGEURL":"/media/35521289/xlm.png","CONVERSIONTYPE":"divide","CONVERSIONSYMBOL":"BTC"}},"XTZ":{"BTC":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"XTZ","TOSYMBOL":"BTC","FLAGS":"2052","PRICE":0.0002386,"LASTUPDATE":1576216068,"MEDIAN":0.000239,"LASTVOLUME":418.2752,"LASTVOLUMETO":0.10003051408,"LASTTRADEID":"582798","VOLUMEDAY":5143703.416007445,"VOLUMEDAYTO":1257.6812920315533,"VOLUME24HOUR":17163476.936890107,"VOLUME24HOURTO":4042.2445998316707,"OPENDAY":0.0002449,"HIGHDAY":0.0002548,"LOWDAY":0.0002335,"OPEN24HOUR":0.0002161,"HIGH24HOUR":0.0002552,"LOW24HOUR":0.0002113,"LASTMARKET":"OKEX","VOLUMEHOUR":445864.71419516933,"VOLUMEHOURTO":107.27301326341215,"OPENHOUR":0.0002389,"HIGHHOUR":0.0002432,"LOWHOUR":0.0002378,"TOPTIERVOLUME24HOUR":17091340.217048977,"TOPTIERVOLUME24HOURTO":4025.111986875438,"CHANGE24HOUR":0.000022500000000000005,"CHANGEPCT24HOUR":10.411846367422491,"CHANGEDAY":-0.0000062999999999999905,"CHANGEPCTDAY":-2.5724785626786404,"CHANGEHOUR":-3.000000000000073e-7,"CHANGEPCTHOUR":-0.12557555462536932,"SUPPLY":810904882.005803,"MKTCAP":193481.9048465846,"TOTALVOLUME24H":43163402.86585187,"TOTALVOLUME24HTO":10245.826926481948,"TOTALTOPTIERVOLUME24H":43062002.89332772,"TOTALTOPTIERVOLUME24HTO":10221.712101435547,"IMAGEURL":"/media/35651213/tezos-logo.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"USD":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"XTZ","TOSYMBOL":"USD","FLAGS":"2049","PRICE":1.725,"LASTUPDATE":1576216057,"MEDIAN":1.7319,"LASTVOLUME":170.72,"LASTVOLUMETO":294.099344,"LASTTRADEID":"653547","VOLUMEDAY":2540006.0750711467,"VOLUMEDAYTO":4498258.680313578,"VOLUME24HOUR":7875452.48808513,"VOLUME24HOURTO":13495457.121820197,"OPENDAY":1.768,"HIGHDAY":1.857,"LOWDAY":1.683,"OPEN24HOUR":1.544,"HIGH24HOUR":1.858,"LOW24HOUR":1.514,"LASTMARKET":"Coinbase","VOLUMEHOUR":180312.83944044003,"VOLUMEHOURTO":313896.40796377795,"OPENHOUR":1.727,"HIGHHOUR":1.753,"LOWHOUR":1.723,"TOPTIERVOLUME24HOUR":7875452.48808513,"TOPTIERVOLUME24HOURTO":13495457.121820197,"CHANGE24HOUR":0.18100000000000005,"CHANGEPCT24HOUR":11.722797927461142,"CHANGEDAY":-0.04299999999999993,"CHANGEPCTDAY":-2.432126696832575,"CHANGEHOUR":-0.0020000000000000018,"CHANGEPCTHOUR":-0.11580775911986113,"SUPPLY":810904882.005803,"MKTCAP":1398810921.4600103,"TOTALVOLUME24H":43163402.86585187,"TOTALVOLUME24HTO":74367171.52346784,"TOTALTOPTIERVOLUME24H":43062002.89332772,"TOTALTOPTIERVOLUME24HTO":74192256.57086366,"IMAGEURL":"/media/35651213/tezos-logo.png","CONVERSIONTYPE":"direct","CONVERSIONSYMBOL":""},"ETH":{"TYPE":"5","MARKET":"CCCAGG","FROMSYMBOL":"XTZ","TOSYMBOL":"ETH","FLAGS":"2052","PRICE":0.0119240379810095,"LASTUPDATE":1576216068,"MEDIAN":0.011944027986007,"LASTVOLUME":418.2752,"LASTVOLUMETO":4.987529371314343,"LASTTRADEID":"582798","VOLUMEDAY":5143703.416007445,"VOLUMEDAYTO":61333.71489552107,"VOLUME24HOUR":17163476.936890107,"VOLUME24HOURTO":204657.9508816582,"OPENDAY":0.01223888055972014,"HIGHDAY":0.0127336331834083,"LOWDAY":0.01166916541729135,"OPEN24HOUR":0.01079960019990005,"HIGH24HOUR":0.0127536231884058,"LOW24HOUR":0.01055972013993004,"LASTMARKET":"OKEX","VOLUMEHOUR":445864.71419516933,"VOLUMEHOURTO":5316.507786455143,"OPENHOUR":0.01193903048475762,"HIGHHOUR":0.01215392303848076,"LOWHOUR":0.01188405797101449,"TOPTIERVOLUME24HOUR":17091340.217048977,"TOPTIERVOLUME24HOURTO":203797.7898944471,"CHANGE24HOUR":0.0011244377811094487,"CHANGEPCT24HOUR":10.41184636742252,"CHANGEDAY":-0.0003148425787106411,"CHANGEPCTDAY":-2.572478562678615,"CHANGEHOUR":-0.000014992503748119737,"CHANGEPCTHOUR":-0.12557555462531436,"SUPPLY":810904882.005803,"MKTCAP":9669260.612023221,"TOTALVOLUME24H":43163402.86585187,"TOTALVOLUME24HTO":514682.055162032,"TOTALTOPTIERVOLUME24H":43062002.89332772,"TOTALTOPTIERVOLUME24HTO":513472.9580383807,"IMAGEURL":"/media/35651213/tezos-logo.png","CONVERSIONTYPE":"divide","CONVERSIONSYMBOL":"BTC"}}}
"""

